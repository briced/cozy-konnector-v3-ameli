language: node_js
node_js:
  - '8'
env:
  global:
    - secure: "iEU6P9cbuDOcZ2klMIgkIucGBTxUHp7A7ZcQTHBdmmwQlTCw2nqF1Mh9145Uycu3os64my4QCokHlPlgLgxvMDou+kLDJqx0EwSE7brZs8+NkefeEBTolOOCpnhfcMqhtO9eDznTUEZZKXylRIo/ZRqVcXSs6VRexG6nY+LjVX/ss0ISEs+ih8atauK8m61zJxlrQjHGP0jPxXWAK1hAXQW+qU0/KDN+UPYZmwoV4PSDB43LAN0gciFnUIcZZXSYqSLma5u7oX8MEH1cGC7IrvGxvEumYUCvREc+z49N1qoFM3TP4Mb92aHOcKX3VwUubRUX3PS2WxnO9hNmUQAif61+NTdf3et3jJ8lPmU351X9y51NYi+INXgljTLjjm+BvR2LuDT2iuWHzTFrYxzc9bD4uR/dukzDD0SYAvmYVzqrGqhhXpMvKB3Bb/r5lNKYVwm+OsqqQNxG2XGrbon8YnY2l4cbTyd5eDgHVqIrZKL5zb59LssF4rBL6IlMl4kx88dfn7a6NSGRQYxqap0OwmwoWCDGfBiEEjcwh3lwRlP2Hu6r4b0nN2n8N1wH10JQQlZnMhqQFB301f8hQgm5X0+aQZ6HrIgBcZC9p6TVNCMHpfCjdgma1k4YfMRFzCM5qw1gZVamFCvX6w1Q5MIJguxJ+GKjZvkp5dZWdWdysOI="
  matrix:
    # kosssi account
    - secure: MhE6co+33V7zAChGxZMowpsNBpEDc5bA9STbqqSINCuzWpYF5I2u/4NMqqOK2SWhUmrW/B7yazdlvLM4+UT2OHfn11Jw8+sX1szkn6JoD5o1nNrI1rITx+4MLBEDFgs8FXiaTeg785d7b7i85PubikyaQYiSW7wRyoChcCFD6BLzw84CZHeGdD9XyKMwVuWps2ZzP6XijP5s6UD1ex9g8rCuqGjqrlESMQ7DBWT4DaQKGfAp3iF1LIjELBDyuLllwSMTgYvrwRueti7kO4LnnXaYMTLcyppr2Ztl3dtocsTvnaoff/XvwK1CfRnnW9G/a6ZilKrBEJ9NvWmPwNe4qbCBMcAb9c4GqJHWnRyCV8rOZYnrpS3w/IMrOeodr2ZZp6oQULFHCXXFSWU6DSeeZltmREeAMCw6gi30UO9ikaoo5m18wLDbs969A8v3VlXEyDzf4bx4MLtNPXBNEChZhQTmzLrBiTYLOKFL42nnSfRqCqu7yZ3AWdz9shgowK40DF2GhD+zSoRdRZst9TBnI/zjkzl11G+/71SptgYDNjmHFbzprQEydLal4pdzpztSAnz/lP9fePsw7Nx4zo5x8+XUuKx4N7JqdPEguSgP5bmFxcwwDvks2d1SZTy683lqtsCKr71iEzhKjpLZle6rIjYCdT7emPraYOZXRnSDnzA=
    # doubleface account
    - secure: WGDv0ZfknIO7SIgT+eiaKn8i7U7kvN3mG9eYvPeHBK64mC6pqMwYsWLEWTD1y3y5z/fz99yFRWXzgl+J+zq2RfkhmD2aEg/Dv1ZuTpPVgvQwG/Hpie37xxUcM3gghh+2nR4pPAqYgC9LLTLlz7SaKHexBEuE644PWvZuHTGzk8ybV53xbWJtHTHxE95RI1Qwp1Qz+lUHOd4VZLPS1Q0bCV6uaL31SeXEW8z3o/Jsgh0g11JfX27mg6bJC3h5TGndfkoxynXp9jlc95GTIRebc4R7/rnNcMPgFb4hyvKFjCiRyY1u/p/pexlwqxJ/UogjixXkz9QDd4xhC2Oi3NNdRg/lDBodwzl6Ro8Jpv7XE764q3mVq00YTHN1exAXgoNBSjfXzkV0jJ9prPZ3oh61KLmuKW6PuyFleeW+1Y28VhCemZx99eUWKtRsB+yDtj3Aq180kYdMlR4JLHNRC2gan60wbM4GuvgzvX5mVeEbig4WUloXvWoeYxUDXfP5lhLk7Suv3+i36lP1+KMTFDktKV2EI9MPqhaoTAGzUOoiQBSp8OFIkPVqYXx7pSBKHPGNnH5XFgW0FbyqO+kXDs+Gl5uv8QZFBubB6/hTnNiFimydybveJhWMv3Mq7aGpmGW9lEODAnrRcLfde7UVJScayx3JgIM/xtF5D4Ddnj7fjr8=
cache:
  yarn: true
  directories:
    - node_modules
script:
  - yarn build
  - if [ $TRAVIS_SECURE_ENV_VARS = "true" ]; then yarn test; fi
deploy:
  - provider: pages
    repo: konnectors/cozy-konnector-ameli
    skip-cleanup: true
    github-token: $GITHUB_TOKEN
    target-branch: build
    local-dir: ./build
    on:
      branch: master
  - provider: pages
    repo: konnectors/cozy-konnector-ameli
    skip-cleanup: true
    github-token: $GITHUB_TOKEN
    target-branch: latest
    local-dir: ./build
    on:
      branch: prod
